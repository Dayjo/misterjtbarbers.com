var ajax={init:function(){if(window.ActiveXObject)return new ActiveXObject("Microsoft.XMLHTTP");else if(window.XMLHttpRequest)return new XMLHttpRequest;return false},arrayToString:function(e,t){var n="";for(var r in e){if(e[r]instanceof Array){e[r]=this.arrayToString(e[r],t+"["+r+"]")}else{e[r]="&"+t+"["+r+"]="+encodeURIComponent(e[r])}}for(var r in e){n+=e[r]}return n},formToData:function(e){var t=new Array;var n=document.getElementById(e);var r=n.querySelectorAll("input,textarea,select");for(i=0;i<r.length;++i){t[r[i].name]=r[i].value}return t},dataToForm:function(e,t){for(var n in t){var r=document.getElementById(e+n);if(r){r.value=t[n]}}},send:function(e,t,n,r,i,s){var o=ajax.init();o.open(t,e,i);o.onreadystatechange=function(){if(this.readyState==4&&this.status==200){s(this.responseText)}};if(r){o.setRequestHeader("Cookie",r)}if(t=="POST"){o.setRequestHeader("Content-type","application/x-www-form-urlencoded");o.send(n)}else{o.send(null)}}}